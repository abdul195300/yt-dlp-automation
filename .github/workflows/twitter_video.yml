name: Twitter Video Downloader

on:
  workflow_dispatch:
    inputs:
      tweet_url:
        description: 'Twitter Video URL'
        required: true

jobs:
  download-video:
    runs-on: ubuntu-latest

    steps:
      - name: 🛠️ تحميل المستودع
        uses: actions/checkout@v4

      - name: 🐍 تثبيت Python والاعتماديات
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: 📦 تثبيت yt-dlp
        run: |
          python -m pip install --upgrade pip
          pip install yt-dlp requests

      - name: 🎥 تشغيل كود تحميل الفيديو
        run: python twitter_video.py "${{ github.event.inputs.tweet_url }}"

      - name: 🔄 إرسال النتيجة عبر API
        run: |
          VIDEO_URL=$(python twitter_video.py "${{ github.event.inputs.tweet_url }}")
          echo "🔗 رابط الفيديو: $VIDEO_URL"
          
          # إرسال النتيجة إلى Webhook أو API خاص
          curl -X POST -H "Content-Type: application/json" -d "{\"tweet_url\": \"${{ github.event.inputs.tweet_url }}\", \"video_url\": \"$VIDEO_URL\"}" "https://your-server.com/api/github-result"
